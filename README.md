# PhotoBackupTool · 照片 / 视频备份工具

这是一个面向**摄影与视频素材整理场景**的桌面备份工具，用于将指定源目录中的媒体文件，按文件类型自动分流备份到不同目标目录。

工具支持 **JPEG / RAW / 视频** 多类型文件，支持并行复制、进度监控与日志记录，适合用于**大规模素材备份、迁移与长期归档**。

---

## 功能特点

### 📁 媒体文件识别

- 递归扫描源目录，自动识别媒体文件
- 支持的文件类型：
  - **JPEG / PNG**
  - **多品牌 RAW 格式**（用户可配置）
  - **多种视频格式**（用户可配置）

### 🎯 分类备份

- 可分别为 **JPEG / RAW / 视频** 设置独立目标目录
- 支持保留源目录的文件夹结构（可选）

### 🔄 重复文件处理策略

- 覆盖已有文件
- 跳过重复文件
- 自动重命名（避免文件名冲突）

### ⚡ 高性能并行复制

- 支持自定义并行度（最大并发复制数）
- 基于**目标磁盘路径的并行限流策略**，减少同一磁盘的写入争用
- 针对大文件采用高性能复制策略（顺序读 + 大缓冲区）

### 📊 精细进度反馈

- 总体进度
- 单文件进度
- 当前文件名
- 实时吞吐量（Bytes/s）
- 已用时间 / 预计剩余时间

### ❌ 操作控制与异常处理

- 支持中途取消备份操作
- 完整记录异常与错误日志，便于事后排查

---

## 界面说明

主界面由以下功能区域组成：

### 1. 文件夹选择区域

- 源目录选择（支持递归扫描）
- JPEG 目标目录
- RAW 目标目录
- 视频目标目录（可选；未设置时回退到 JPEG 目录）

### 2. 格式选择区域

- RAW 文件格式选择（支持多品牌、多机型）
- 视频文件格式选择（常见视频封装格式）

### 3. 备份设置区域

- 重复文件处理策略选择（覆盖 / 跳过 / 自动重命名）
- 最大并行度设置（控制同时进行的文件复制数量）
- 操作日志与状态信息显示

### 4. 进度显示区域

- 总体进度条
- 当前任务状态提示
- 实时复制进度信息
- **开始备份 / 取消备份** 控制按钮

---

## 工作流程

1. 扫描源目录，递归获取所有符合条件的媒体文件
2. 统计文件总数与总体字节数
3. 在目标位置**预先创建完整目录结构**（避免并行复制时的目录竞态）
4. 按目标磁盘路径对文件进行分组，并限制单磁盘并发数
5. 启动异步并行复制任务
6. 持续汇报单文件与总体复制进度
7. 任务完成或取消后，输出最终执行结果

---

## 项目结构

```text
PhotoBackupTool/
├── MainForm.cs                # 主窗体逻辑与 UI 交互
├── MainForm.Designer.cs       # WinForms 界面定义
├── BackupManager.cs           # 备份调度与任务分发（队列 / 通道管理）
├── BackupItem.cs              # 单个备份文件的描述模型（源路径 / 目标路径 / 大小）
├── CopyWorker.cs              # 实际文件复制 Worker（异步读写 / 进度上报）
├── ProgressAggregator.cs      # 多通道进度聚合与 UI 节流更新
├── Scanner.cs                 # 源目录扫描与文件分类逻辑
├── BackupSettings.cs          # 备份配置模型（路径 / 格式 / 并行度等）
├── BackupProgressInfo.cs      # 进度信息数据结构（总体 / 单文件 / 通道）
├── ErrorLogger.cs             # 错误与异常日志记录
├── Program.cs                 # 程序入口
├── PhotoBackupTool.csproj     # 项目文件
└── README.md                  # 使用说明

```

---

## 运行环境

- **操作系统**：Windows 7 / 8 / 10 / 11
- **运行时**：.NET Framework 4.x 或 .NET 6+
- **架构建议**：64 位运行环境（大文件与多线程复制场景）
- **文件系统**：建议使用 NTFS / exFAT

---

## 使用方法

1. 启动程序
2. 选择源目录
3. 分别设置 JPEG / RAW / 视频目标目录
4. 勾选需要处理的 RAW 与视频格式
5. 选择重复文件处理策略
6. 设置并行度
7. 点击 **「开始备份」**
8. 通过进度区域与日志观察执行状态

---

## 并行度选择建议

| 使用场景 | 推荐并行度 | 说明 |
|----------|------------|------|
| 单机械硬盘（HDD） | 1–2 | 避免频繁寻道 |
| 单 SSD / NVMe | 4–8 | 充分利用 SSD 性能 |
| 多磁盘或多目标路径 | 8–16 | 并行分布到不同磁盘 |
| 网络存储（NAS / SMB） | 4–8 | 取决于网络与 NAS 性能 |

⚠️ **注意**：并行度过高可能导致性能下降或系统负载过高，请根据实际环境调整。

---

## 注意事项

- 确保目标磁盘拥有充足的可用空间
- 备份过程中避免强制关闭程序
- 网络路径请确保连接稳定
- 大规模备份前，建议先进行小批量测试

---

## 使用说明与免责声明

- PhotoBackupTool 为个人开发的文件备份工具，主要用于照片、视频等大批量文件的复制与整理。
- 本软件按“现状（AS IS）”提供，作者不对因使用本软件导致的任何数据丢失、硬件损坏、系统异常或其他直接或间接损失承担任何责任。
- 大批量、多线程文件复制可能会对磁盘产生持续高负载，请在使用前确认磁盘状态良好，并自行做好重要数据备份。
- 使用本软件即表示您已理解并接受相关风险。

